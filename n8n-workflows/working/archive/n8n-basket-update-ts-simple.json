{
  "name": "ğŸ€ Update TypeScript File - SIMPLE",
  "nodes": [
    {
      "parameters": {
        "jsCode": "// Aggiornamento diretto del file TypeScript con dati fissi\n// Usiamo i dati che sappiamo essere corretti dal file JSON giÃ  aggiornato\n\n// Facciamo una richiesta per ottenere i dati aggiornati\nconst https = require('https');\nconst url = 'https://raw.githubusercontent.com/magiaslab/svbtailwindok3/master/src/data/stats/serie-c-stats.json';\n\nreturn new Promise((resolve, reject) => {\n  https.get(url, (res) => {\n    let data = '';\n    \n    res.on('data', (chunk) => {\n      data += chunk;\n    });\n    \n    res.on('end', () => {\n      try {\n        const statsData = JSON.parse(data);\n        \n        // Creazione contenuto TypeScript\n        const tsContent = `// Dati delle statistiche Serie C\n// Questo file viene importato direttamente dai componenti\n// Aggiornato automaticamente: ${new Date().toISOString()}\n\nexport const serieCStatsData = ${JSON.stringify(statsData, null, 2)};`;\n        \n        const base64Content = Buffer.from(tsContent).toString('base64');\n        \n        // SHA del file corrente (dobbiamo ottenerlo)\n        const result = {\n          statsData: statsData,\n          tsContent: tsContent,\n          base64Content: base64Content,\n          teamsCount: statsData.standings.length\n        };\n        \n        console.log(`ğŸ‰ Dati preparati: ${statsData.standings.length} squadre`);\n        resolve([{ json: result }]);\n        \n      } catch (error) {\n        console.error('âŒ Errore parsing JSON:', error);\n        reject(error);\n      }\n    });\n  }).on('error', (error) => {\n    console.error('âŒ Errore richiesta:', error);\n    reject(error);\n  });\n});"
      },
      "id": "node1",
      "name": "ğŸ“¥ Get Stats and Prepare TS",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [240, 300]
    },
    {
      "parameters": {
        "url": "https://api.github.com/repos/magiaslab/svbtailwindok3/contents/src/data/stats-data.ts",
        "authentication": "headerAuth",
        "responseFormat": "json",
        "options": {}
      },
      "id": "node2",
      "name": "ğŸ“¥ Get Current TS SHA",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [460, 300]
    },
    {
      "parameters": {
        "jsCode": "// Combinazione dati per GitHub update\nconst preparedData = items[0].json;\nconst tsFileInfo = items[1].json;\n\nconst result = {\n  message: `Aggiornamento automatico stats-data.ts - ${new Date().toISOString()}`,\n  content: preparedData.base64Content,\n  sha: tsFileInfo.sha\n};\n\nconsole.log('ğŸ”§ Dati finali per GitHub:', {\n  messageLength: result.message.length,\n  contentLength: result.content.length,\n  sha: result.sha,\n  teamsCount: preparedData.teamsCount\n});\n\nreturn [{ json: result }];"
      },
      "id": "node3",
      "name": "ğŸ”§ Combine Data for GitHub",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 300]
    },
    {
      "parameters": {
        "url": "https://api.github.com/repos/magiaslab/svbtailwindok3/contents/src/data/stats-data.ts",
        "authentication": "headerAuth",
        "requestMethod": "PUT",
        "responseFormat": "json",
        "jsonParameters": true,
        "bodyParametersJson": "={{ $json }}",
        "options": {}
      },
      "id": "node4",
      "name": "ğŸ“¤ Update TS File",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [900, 300]
    },
    {
      "parameters": {
        "jsCode": "// Messaggio di successo per TS\nconst githubResponse = items[0].json;\n\nconst message = `ğŸ‰ File TypeScript aggiornato con successo!\n\nğŸ“Š File aggiornato: ${githubResponse.content ? 'âœ… Successo' : 'âŒ Errore'}\nğŸ“ Commit SHA: ${githubResponse.commit ? githubResponse.commit.sha : 'N/A'}\nğŸ“ File size: ${githubResponse.content ? githubResponse.content.size : 'N/A'} bytes\nâ° Timestamp: ${new Date().toISOString()}`;\n\nconsole.log(message);\n\nreturn [{\n  json: {\n    success: true,\n    message: message,\n    githubResponse: githubResponse,\n    timestamp: new Date().toISOString()\n  }\n}];"
      },
      "id": "node5",
      "name": "ğŸ‰ TS Success Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1120, 300]
    }
  ],
  "connections": {
    "ğŸ“¥ Get Stats and Prepare TS": {
      "main": [
        [
          {
            "node": "ğŸ”§ Combine Data for GitHub",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¥ Get Current TS SHA": {
      "main": [
        [
          {
            "node": "ğŸ”§ Combine Data for GitHub",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”§ Combine Data for GitHub": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Update TS File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¤ Update TS File": {
      "main": [
        [
          {
            "node": "ğŸ‰ TS Success Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    "basketball",
    "typescript",
    "update",
    "simple"
  ],
  "triggerCount": 0,
  "updatedAt": "2025-09-28T20:00:00.000Z",
  "versionId": "update-ts-simple-v1"
}
