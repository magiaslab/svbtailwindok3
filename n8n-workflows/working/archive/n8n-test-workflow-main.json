{
  "name": "üß™ Test Workflow Main",
  "nodes": [
    {
      "parameters": {
        "url": "https://www.playbasket.it/toscana/league.php?lt=2&lf=M&lr=TO&lp=FI&lc=C%2FM&lg=1&mod=st",
        "responseFormat": "string"
      },
      "id": "http-test",
      "name": "Get HTML",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [260, 300]
    },
    {
      "parameters": {
        "jsCode": "// === TEST DEL WORKFLOW PRINCIPALE ===\nconsole.log('üß™ Test del workflow principale...');\n\n// Accesso ai dati HTML (stesso codice del workflow principale)\nlet htmlData = '';\nif (items && items.length > 0) {\n  const item = items[0];\n  console.log('üì• Item ricevuto:', typeof item, Object.keys(item || {}));\n  \n  // Usa la stessa logica del workflow principale\n  if (item.json && item.json.data && typeof item.json.data === 'string' && item.json.data.length > 1000) {\n    htmlData = item.json.data;\n    console.log('‚úÖ HTML trovato in item.json.data');\n  } else if (item.json && typeof item.json === 'string' && item.json.length > 1000) {\n    htmlData = item.json;\n    console.log('‚úÖ HTML trovato in item.json (string)');\n  } else if (item.data && typeof item.data === 'string' && item.data.length > 1000) {\n    htmlData = item.data;\n    console.log('‚úÖ HTML trovato in item.data');\n  } else {\n    console.log('‚ùå Struttura dati:', {\n      hasJson: !!item.json,\n      jsonType: typeof item.json,\n      jsonLength: item.json ? item.json.length : 0,\n      hasJsonData: !!(item.json && item.json.data),\n      jsonDataType: item.json && item.json.data ? typeof item.json.data : 'undefined',\n      jsonDataLength: item.json && item.json.data ? item.json.data.length : 0,\n      hasData: !!item.data,\n      dataType: typeof item.data\n    });\n  }\n}\n\nif (!htmlData || htmlData.length < 1000) {\n  return [{\n    json: {\n      error: 'HTML_NOT_FOUND',\n      message: 'Impossibile accedere ai dati HTML',\n      debug: {\n        htmlLength: htmlData ? htmlData.length : 0\n      }\n    }\n  }];\n}\n\n// Test parsing rapido\nconst tableRegex = /<table[^>]*class=[\"']league_standings_ranking stats[\"'][^>]*>([\\s\\S]*?)<\\/table>/i;\nconst tableMatch = htmlData.match(tableRegex);\n\nif (!tableMatch) {\n  return [{\n    json: {\n      error: 'TABLE_NOT_FOUND',\n      message: 'Tabella non trovata',\n      debug: {\n        htmlLength: htmlData.length,\n        htmlPreview: htmlData.substring(0, 500)\n      }\n    }\n  }];\n}\n\n// Conta righe\nconst rowRegex = /<tr[^>]*>([\\s\\S]*?)<\\/tr>/gi;\nconst rows = [];\nlet match;\n\nwhile ((match = rowRegex.exec(tableMatch[1])) !== null) {\n  rows.push(match[1]);\n}\n\nconst teamsFound = Math.max(0, rows.length - 1); // Esclude header\n\nconst testResult = {\n  timestamp: new Date().toISOString(),\n  success: teamsFound > 5,\n  htmlAccess: {\n    success: true,\n    htmlLength: htmlData.length,\n    method: 'detected_automatically'\n  },\n  parsing: {\n    tableFound: true,\n    teamsFound: teamsFound,\n    success: teamsFound > 5\n  },\n  message: teamsFound > 5 ? \n    `‚úÖ Workflow principale dovrebbe funzionare: ${teamsFound} squadre` :\n    `‚ùå Problema: solo ${teamsFound} squadre trovate`\n};\n\nconsole.log('üéØ Risultato test workflow principale:', testResult);\n\nreturn [{ json: testResult }];"
      },
      "id": "test-main",
      "name": "Test Main Logic",
      "type": "n8n-nodes-base.code",
      "typeVersion": 1,
      "position": [480, 300]
    }
  ],
  "connections": {
    "Get HTML": {
      "main": [
        [
          {
            "node": "Test Main Logic",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "timezone": "Europe/Rome"
  },
  "versionId": "test-main-v1",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "id": "test-main-workflow",
  "tags": []
}
